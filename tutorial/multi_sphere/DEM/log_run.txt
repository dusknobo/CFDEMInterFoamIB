thermo_log              ../DEM/log_thermo.txt

#变量定义
variable            xmin           equal   0.0
variable            xmax           equal   0.1
variable            ymin           equal   0.0
variable            ymax           equal   0.1
variable            zmin           equal   0.2
variable            zmax           equal   0.4

variable            posx           equal   ${xmax}/2
variable            posx           equal   0.1/2
variable            posy           equal   ${ymax}/2
variable            posy           equal   0.1/2
variable            posz           equal   0.32


variable            vx             equal   0.0
variable            vy             equal   0.0
variable            vz             equal   0.0

variable            rhop           equal   1400

variable            timestep       equal   0.00001
variable            outSteps       equal   1000
##################################################

atom_style          granular
atom_modify         map array
communicate         single vel yes

boundary            f f f
newton              off

units               si
processors          1 1 4

region              reg block ${xmin} ${xmax} ${ymin} ${ymax} ${zmin} ${zmax} units box
region              reg block 0 ${xmax} ${ymin} ${ymax} ${zmin} ${zmax} units box
region              reg block 0 0.1 ${ymin} ${ymax} ${zmin} ${zmax} units box
region              reg block 0 0.1 0 ${ymax} ${zmin} ${zmax} units box
region              reg block 0 0.1 0 0.1 ${zmin} ${zmax} units box
region              reg block 0 0.1 0 0.1 0.2 ${zmax} units box
region              reg block 0 0.1 0 0.1 0.2 0.4 units box
# read_restart        ../DEM/restart/restart.%.60001
create_box          1 reg
Created orthogonal box = (0 0 0.2) to (0.1 0.1 0.4)
  1 by 1 by 4 MPI processor grid

neighbor            0.001 bin
# neigh_modify        delay 0
neigh_modify        delay 1000
#binsize 0.001

# Material properties required for new pair styles

fix                 m1 all property/global youngsModulus peratomtype 5.e7
fix                 m2 all property/global poissonsRatio peratomtype 0.45
fix                 m3 all property/global coefficientRestitution peratomtypepair 1 0.3
fix                 m4 all property/global coefficientFriction peratomtypepair 1 0.5

# pair style
pair_style          gran model hertz tangential history
# Hertzian without cohesion
pair_coeff          * *

# timestep, gravity
timestep            ${timestep}
timestep            1e-05

fix                 gravi all gravity 9.81 vector 0.0 0.0 -1.0

# walls
fix                 xwalls1 all wall/gran model hertz tangential history primitive type 1 xplane 0.0
fix                 xwalls2 all wall/gran model hertz tangential history primitive type 1 xplane 0.1
fix                 ywalls1 all wall/gran model hertz tangential history primitive type 1 yplane 0.0
fix                 ywalls2 all wall/gran model hertz tangential history primitive type 1 yplane 0.1
fix                 zwalls1 all wall/gran model hertz tangential history primitive type 1 zplane 0.2
# fix                 zwalls2 all wall/gran model hertz tangential history primitive type 1 zplane ${zmax}

# cfd coupling
fix                 cfd  all couple/cfd couple_every 100 mpi
couple_every as specified in LIGGGHTS is overriden by calling external program (../fix_cfd_coupling.cpp:114)
fix                 cfd2 all couple/cfd/force

#distributions for insertion
fix                 pts1 all particletemplate/multisphere 15485863                     atom_type 1                     density constant ${rhop}                     nspheres 4                     ntry 1000000                     spheres file ../DEM/data/test                     scale 0.0005                     type 1
fix                 pts1 all particletemplate/multisphere 15485863                     atom_type 1                     density constant 1400                     nspheres 4                     ntry 1000000                     spheres file ../DEM/data/test                     scale 0.0005                     type 1
Finished calculating properties of template
   mass = 5.865754e-03, radius of bounding sphere = 1.000000e-02, radius of equivalent sphere = 1.000082e-02
   center of mass = 0.000000e+00, 0.000000e+00, 0.000000e+00
   center of bounding sphere in body coords = -2.982927e-06, 5.110261e-06, 2.717267e-07
   Principal moments of inertia_: 2.347259e-07, 2.339761e-07, 2.344389e-07
     Eigenvector: 6.692478e-01, -2.750354e-02, -7.425301e-01
     Eigenvector: -5.950681e-01, 5.786065e-01, -5.577709e-01
     Eigenvector: 4.449735e-01, 8.151430e-01, 3.708646e-01
     Inertia tensor: 2.344035e-07, 1.540676e-10, -2.962294e-10
     Inertia tensor: 1.540676e-10, 2.342841e-07, 1.552236e-10
     Inertia tensor: -2.962294e-10, 1.552236e-10, 2.344531e-07
# scale 0.00005

fix                 pdd1 all particledistribution/discrete 15485867                     1 pts1 1.0

# region              bc block 0.0041 0.0059 0.0041 0.0059 0.012 0.0138 #                    units box

#fix                ins all insert/pack seed 32452843 #                   distributiontemplate pdd1 #                   maxattempt 1000 vel constant 0. 0. 0 #                   insert_every 1 overlapcheck yes #                   region bc particles_in_region 1

region              bc block 0.02 0.08 0.02 0.08 0.30 0.34                     units box
fix                 ins all insert/pack/custom seed 32452843                     distributiontemplate pdd1                     maxattempt 1000 insert_every once                     vel constant ${vx} ${vy} ${vz}                     overlapcheck no all_in no                     region bc particles_in_region 1                     number_of_points 1 atP                     ${posx} ${posy} ${posz}                     ntry_mc 1000
fix                 ins all insert/pack/custom seed 32452843                     distributiontemplate pdd1                     maxattempt 1000 insert_every once                     vel constant 0 ${vy} ${vz}                     overlapcheck no all_in no                     region bc particles_in_region 1                     number_of_points 1 atP                     ${posx} ${posy} ${posz}                     ntry_mc 1000
fix                 ins all insert/pack/custom seed 32452843                     distributiontemplate pdd1                     maxattempt 1000 insert_every once                     vel constant 0 0 ${vz}                     overlapcheck no all_in no                     region bc particles_in_region 1                     number_of_points 1 atP                     ${posx} ${posy} ${posz}                     ntry_mc 1000
fix                 ins all insert/pack/custom seed 32452843                     distributiontemplate pdd1                     maxattempt 1000 insert_every once                     vel constant 0 0 0                     overlapcheck no all_in no                     region bc particles_in_region 1                     number_of_points 1 atP                     ${posx} ${posy} ${posz}                     ntry_mc 1000
fix                 ins all insert/pack/custom seed 32452843                     distributiontemplate pdd1                     maxattempt 1000 insert_every once                     vel constant 0 0 0                     overlapcheck no all_in no                     region bc particles_in_region 1                     number_of_points 1 atP                     0.05 ${posy} ${posz}                     ntry_mc 1000
fix                 ins all insert/pack/custom seed 32452843                     distributiontemplate pdd1                     maxattempt 1000 insert_every once                     vel constant 0 0 0                     overlapcheck no all_in no                     region bc particles_in_region 1                     number_of_points 1 atP                     0.05 0.05 ${posz}                     ntry_mc 1000
fix                 ins all insert/pack/custom seed 32452843                     distributiontemplate pdd1                     maxattempt 1000 insert_every once                     vel constant 0 0 0                     overlapcheck no all_in no                     region bc particles_in_region 1                     number_of_points 1 atP                     0.05 0.05 0.32                     ntry_mc 1000

#create single partciles
# create_atoms       1 single 0.05 0.05 0.35  units box
# set                atom 1 diameter 0.02 density 1500 vx 0 vy 0 vz 0

#apply nve integration to all particles that are inserted as single particles
fix                 integr all multisphere
# fix                 integr all nve/sphere

# screen output
compute             rke all erotate/sphere
thermo_style        custom step atoms ke c_rke vol
thermo              1000
thermo_modify       lost ignore norm no
compute_modify      thermo_temp dynamic yes
WARNING: Changing thermo_temp compute object. This object is deprecated and will be removed in the future. (../compute.cpp:161)

# output every N steps
dump                dmp all custom ${outSteps} ../DEM/post/dump*.liggghts                     id type x y z ix iy iz vx vy vz fx fy fz                     omegax omegay omegaz radius
dump                dmp all custom 1000 ../DEM/post/dump*.liggghts                     id type x y z ix iy iz vx vy vz fx fy fz                     omegax omegay omegaz radius
                    # cluster

run                 1
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:03 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
INFO: Particle insertion ins: inserting every 0 steps
Memory usage per processor = 4.23717 Mbytes
    Step    Atoms         KinEng            rke         Volume 
       0        0              0              0          0.002 
INFO: Particle insertion ins: inserted 1 particle templates (mass 5.865754e-03) at step 1
 - a total of 1 particle templates (mass 5.865754e-03) inserted so far.
       1        4  7.0562156e-12              0          0.002 
Loop time of 0.00062161 on 4 procs for 1 steps with 4 atoms, finish time Fri Mar 17 03:38:03 2023


Pair  time (%) = 6.66e-07 (0.107141)
Neigh time (%) = 1.0766e-05 (1.73195)
Comm  time (%) = 0.000129146 (20.7761)
Outpt time (%) = 2.39678e-05 (3.85576)
Other time (%) = 0.000457064 (73.5291)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 1
Dangerous builds = 0

run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:03 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
       1        4  7.0562156e-12              0          0.002 
CFD Coupling established at step 100
     101        4  2.8507817e-07              0          0.002 
Loop time of 0.000344448 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:03 2023


Pair  time (%) = 1.50452e-05 (4.36793)
Neigh time (%) = 0 (0)
Comm  time (%) = 3.5031e-05 (10.1702)
Outpt time (%) = 0.000136969 (39.7647)
Other time (%) = 0.000157403 (45.6971)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:06 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     101        4  2.8507817e-07              0          0.002 
CFD Coupling established at step 200
     201        4  1.1336773e-06              0          0.002 
Loop time of 0.000508543 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:06 2023


Pair  time (%) = 1.9354e-05 (3.80577)
Neigh time (%) = 0 (0)
Comm  time (%) = 4.33058e-05 (8.51565)
Outpt time (%) = 0.00018443 (36.2664)
Other time (%) = 0.000261453 (51.4122)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:08 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     201        4  1.1336773e-06              0          0.002 
CFD Coupling established at step 300
     301        4  2.5456641e-06              0          0.002 
Loop time of 0.000382792 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:08 2023


Pair  time (%) = 1.5075e-05 (3.93816)
Neigh time (%) = 0 (0)
Comm  time (%) = 4.6762e-05 (12.216)
Outpt time (%) = 0.000149275 (38.9963)
Other time (%) = 0.000171681 (44.8496)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:10 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     301        4  2.5456641e-06              0          0.002 
CFD Coupling established at step 400
     401        4  4.5209674e-06              0          0.002 
Loop time of 0.000497419 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:10 2023


Pair  time (%) = 2.94337e-05 (5.9173)
Neigh time (%) = 0 (0)
Comm  time (%) = 3.46487e-05 (6.96571)
Outpt time (%) = 0.000197087 (39.622)
Other time (%) = 0.000236249 (47.495)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:12 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     401        4  4.5209674e-06              0          0.002 
CFD Coupling established at step 500
     501        4  7.0595354e-06              0          0.002 
Loop time of 0.000493986 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:12 2023


Pair  time (%) = 1.9478e-05 (3.94303)
Neigh time (%) = 0 (0)
Comm  time (%) = 6.13268e-05 (12.4147)
Outpt time (%) = 0.00019587 (39.6511)
Other time (%) = 0.00021731 (43.9912)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:14 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     501        4  7.0595354e-06              0          0.002 
CFD Coupling established at step 600
     601        4  1.0161287e-05              0          0.002 
Loop time of 0.000392887 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:14 2023


Pair  time (%) = 1.5192e-05 (3.86676)
Neigh time (%) = 0 (0)
Comm  time (%) = 5.29795e-05 (13.4847)
Outpt time (%) = 0.000161057 (40.9931)
Other time (%) = 0.000163659 (41.6554)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:16 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     601        4  1.0161287e-05              0          0.002 
CFD Coupling established at step 700
     701        4  1.3826236e-05              0          0.002 
Loop time of 0.000403327 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:16 2023


Pair  time (%) = 3.04628e-05 (7.55288)
Neigh time (%) = 0 (0)
Comm  time (%) = 3.497e-05 (8.67039)
Outpt time (%) = 0.000132842 (32.9365)
Other time (%) = 0.000205052 (50.8403)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:19 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     701        4  1.3826236e-05              0          0.002 
CFD Coupling established at step 800
     801        4   1.805437e-05              0          0.002 
Loop time of 0.000452125 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:19 2023


Pair  time (%) = 1.941e-05 (4.29306)
Neigh time (%) = 0 (0)
Comm  time (%) = 3.46972e-05 (7.67426)
Outpt time (%) = 0.000166517 (36.8298)
Other time (%) = 0.000231501 (51.2028)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:21 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     801        4   1.805437e-05              0          0.002 
CFD Coupling established at step 900
     901        4  2.2845521e-05              0          0.002 
Loop time of 0.000460428 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:21 2023


Pair  time (%) = 1.94263e-05 (4.21917)
Neigh time (%) = 0 (0)
Comm  time (%) = 4.21573e-05 (9.1561)
Outpt time (%) = 0.000186917 (40.5963)
Other time (%) = 0.000211928 (46.0284)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
run 100    
WARNING: It is heavily recommended to use 'neigh_modify delay 0' with granular pair styles (../pair_gran.cpp:237)
Setting up run at Fri Mar 17 03:38:23 2023

WARNING: Energy calculated for multisphere particles is currently not correct (../fix_multisphere.cpp:1334)
Memory usage per processor = 4.241 Mbytes
    Step    Atoms         KinEng            rke         Volume 
     901        4  2.2845521e-05              0          0.002 
CFD Coupling established at step 1000
    1000        4  2.8143511e-05              0          0.002 
    1001        4  2.8199842e-05              0          0.002 
Loop time of 0.000438055 on 4 procs for 100 steps with 4 atoms, finish time Fri Mar 17 03:38:23 2023


Pair  time (%) = 2.03115e-05 (4.63674)
Neigh time (%) = 0 (0)
Comm  time (%) = 3.51972e-05 (8.03488)
Outpt time (%) = 0.000215231 (49.1333)
Other time (%) = 0.000167316 (38.195)

Nlocal:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:    1 ave 4 max 0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Neighs:    0 ave 0 max 0 min
Histogram: 4 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
